<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Lavender Spacecraft🪐✨ Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Lavender Spacecraft🪐✨ Blog Atom Feed"><title data-react-helmet="true">Normalization | Lavender Spacecraft🪐✨</title><meta data-react-helmet="true" property="og:url" content="https://blog-test-lavender.netlify.app//docs/SQL Notes/sqlnorm"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Normalization | Lavender Spacecraft🪐✨"><meta data-react-helmet="true" name="description" content="Notion Notes"><meta data-react-helmet="true" property="og:description" content="Notion Notes"><link data-react-helmet="true" rel="shortcut icon" href="/img/logos/brain_2.svg"><link data-react-helmet="true" rel="canonical" href="https://blog-test-lavender.netlify.app//docs/SQL Notes/sqlnorm"><link data-react-helmet="true" rel="alternate" href="https://blog-test-lavender.netlify.app//docs/SQL Notes/sqlnorm" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://blog-test-lavender.netlify.app//docs/SQL Notes/sqlnorm" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ce975249.css">
<link rel="preload" href="/assets/js/runtime~main.96d6837b.js" as="script">
<link rel="preload" href="/assets/js/main.ba8b2f4f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/my_comic-removebg.PNG" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/my_comic-removebg.PNG" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Inbox🌟</strong></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Algo</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/shuoO-24" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/my_comic-removebg.PNG" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/my_comic-removebg.PNG" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Inbox🌟</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/intro">Algo</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/shuoO-24" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/intro">你好呀</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">SQL Notes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/SQL Notes/sqlintro">SQL Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/SQL Notes/sqlorder">Ordering</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/SQL Notes/sqlnorm">Normalization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/SQL Notes/sqlgroup">SQL Grouping</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/SQL Notes/Important Concepts">Important Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/SQL Notes/sqljoin">SQL Joining</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Dynamic Programming</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Dynamic Programming/algointro">Hello Algorithm</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Dynamic Programming/LeetCode300">最长递增子序列</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Dynamic Programming/LeetCode64">64. Minimum Path Sum — Medium</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Docusaurus References</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Markdown Basics">Basic Syntax</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Code Block">Add Code blocks</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Front-matter">Front-matter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Tabs">A Super Cool Feature -- Tabs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/markdown-features">markdown-features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Admonitions">Use Admonitions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/translate-your-site">Translate your site</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/toc">Inline TOC | Docusaurus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/mdFooter">Footer</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Infima Powered</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Infima Powered/infima">Alert</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/Infima Powered/navbar">Nav bar usage</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/blogsetup">Start Blogging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/Docusaurus_References/sidebar">Sidebar</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Normalization</h1></header><div class="markdown"><p><a href="https://www.notion.so/lavendershuo/Lecture-18-Normalization-03a84694d3a64e54a5c0622ae4332bac" target="_blank" rel="noopener noreferrer">Notion Notes</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="what-is-a-good-relation-design-well-structured-relation"></a>What is a good relation design (Well-Structured Relation)?<a class="hash-link" href="#what-is-a-good-relation-design-well-structured-relation" title="Direct link to heading">#</a></h2><p>We have seen how to create a new relation from a given schema.</p><p>We know that the following <strong>rules</strong> must apply to relations:</p><ol><li><u>Entity Integrity</u>: For each tuple in a relation attributes that belong to the **primary** key must be **non-null**</li><li><u>Referential Integrity</u>: All **foreign** key attribute values in a relation must be either **null** or correspond to a **primary** key value</li><li><strong>Duplication</strong> of tuples in a relation is <strong>not</strong> allowed.</li><li>Next, we look at: - <strong>Normalization</strong></li></ol><p>Basically, a well-structured relation is
<strong>a relation that contains minimal data redundancy and allows users to insert, delete, and update rows without causing data inconsistencies.</strong>
Its goal is to avoid (minimize) anomalies:</p><ul><li>Insertion Anomaly: adding new rows forces user to create duplicate data</li><li>Deletion Anomaly: deleting a row may cause loss of other data representing completely different facts</li><li>Modification Anomaly: changing data in a row forces
changes to other rows because of duplication</li></ul><blockquote><p>General rule of thumb: a table should not pertain to more than one entity type</p></blockquote><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="normalization"></a>Normalization<a class="hash-link" href="#normalization" title="Direct link to heading">#</a></h2><p>Normalization（规范化表格）is <strong>a technique used to organize the data</strong> in a database.</p><ul><li>Normalization consists of <strong>a set of rules</strong> that all relations must follow for a database(DB) to be well structured.</li><li>These <strong>rules</strong> are presented as sets of restrictions called <strong>NORMAL FORMS</strong></li></ul><p><strong>Normalization</strong> is the <strong>process</strong> of creating a DB that complies with these <strong>restrictions</strong>. We do that by normalizing each of the relations.</p><ul><li>Normal forms:<ul><li>1NF (First Normal Form)</li><li>2NF (Second Normal Form)</li><li>3NF (Third Normal Form)</li><li><del>4NF, 5NF, 6NF......</del> It&#x27;s not always a good idea to normalize beyond 3NF.</li></ul></li></ul><p>Applying these rules <strong>removes undesirable properties</strong> from a DB, including the <strong>removal of data anomalies</strong>:
<code>UPDATE ANOMALY</code>, <code>INSERTION ANOMALY</code>, <code>DELETION ANOMAL</code></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="anormalies--example-relation-ta"></a><u>Anormalies</u> | Example: Relation TA<a class="hash-link" href="#anormalies--example-relation-ta" title="Direct link to heading">#</a></h2><p><img src="https://i.loli.net/2021/06/04/rgV1eZFiOyaSCTM.jpg" alt="rgV1eZFiOyaSCTM"></p><p><em>The relation TA is not normalized. Why does this matter?</em></p><ol><li><p>What are the CANDIDATE KEYS of TA?</p><ul><li>{TA_ID, TA_DEPT}</li></ul></li><li><p>What is the PRIMARY KEY of TA?</p><ul><li>{TA_ID, TA_DEPT}</li></ul></li><li><div style="color:tomato"><h4>UPDATE ANOMALY</h4></div></li></ol><ul><li>Ann belongs to <strong>two departments</strong></li><li><strong>If Ann&#x27;s address changes, we will need to update two tuples, to avoid ambiguity</strong></li></ul><ol start="4"><li><div style="color:tomato"><h4>INSERTION ANOMALY</h4></div></li></ol><ul><li><strong>Suppose a new TA has been appointed but does not yet know which department they will work in.</strong></li><li><strong>We cannot put a <code>NULL</code> to <code>TA_DEPT</code> because primary key value cannot be NULL.</strong></li><li>We would <strong>not be able to INSERT</strong> the data into the relation. —&gt; INSERTION ANOMALY</li></ul><ol start="5"><li><div style="color:tomato"><h4>DELETION ANOMALY</h4></div></li></ol><ul><li>Suppose the BIOLOGY <strong>department is closed down</strong></li><li><strong>Deleting tuples with attribute value BIOLOGY in TA_DEPT would delete the information about Bob</strong> — we <strong>do not want to remove Bob</strong>&#x27;s TA_ID, TA_ADDRESS, and other information — thus a DELETION ANOMALY</li></ul><p>How do we resolve or avoid anomalies?</p><ul><li>To resolve or avoid anomalies, we need to <em>normalize</em> relations</li><li>We will continue the above example later in the lecture, after we have discussed 1NF and 2NF.</li></ul><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="normal-forms"></a><u>Normal Forms</u><a class="hash-link" href="#normal-forms" title="Direct link to heading">#</a></h2><p><em>Normalization consists of a set of rules that all relations must follow for a database(DB) to be well structured.
These rules are presented as sets of restrictions called NORMAL FORMS.</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="first-normal-form（1nf"></a><u>First Normal Form（1NF)</u><a class="hash-link" href="#first-normal-form（1nf" title="Direct link to heading">#</a></h3><p><em>Each attribute <strong>name</strong> must consist of a <strong>single</strong> <strong>item</strong>.</em></p><p><em>Each attribute <strong>value</strong> must represent a <strong>single</strong> <strong>fact</strong>.</em></p><p><strong>Example:</strong></p><p><img src="https://i.loli.net/2021/06/04/dqsiF2MuIDPhEVS.jpg" alt="dqsiF2MuIDPhEVS"></p><u>A single fact</u>:<p>Anne is a single fact regarding FirstName; PSTAT 10 is a single fact regarding Course#......</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-relation-course_content"></a>Example: Relation COURSE_CONTENT<a class="hash-link" href="#example-relation-course_content" title="Direct link to heading">#</a></h4><p>A DB design team has been working on the relationships between each COURSE and its SYLLABUS in the Statistics Department. They suggest the following relation.</p><div style="zoom:0.4" class="text--center"><img src="https://i.loli.net/2021/06/04/3p5OAfFXslikRCd.jpg" alt="course"></div><p>COURSE #: PSTAT10, PSTAT126 —— OK</p><p>SYLLABUS: R,SQL Regression, R —— <strong>two</strong> separate facts</p><p>Thus COURSE_CONTENT Not in 1NE</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-decomposing-a-relation-into-first-normal-form1nf"></a>Example: Decomposing A Relation Into First Normal Form(1NF)<a class="hash-link" href="#example-decomposing-a-relation-into-first-normal-form1nf" title="Direct link to heading">#</a></h4><div style="zoom:0.4" class="text--center"><img src="https://i.loli.net/2021/06/04/3p5OAfFXslikRCd.jpg" alt="1NF"></div><p>R, SQL for PSTAT10 become <strong>separate</strong> <strong>tuples</strong>.</p><p>So COURSE_CONTENT2 is in 1NF</p><p>A new example:</p><div style="zoom:0.4" class="text--center"><img src="https://i.loli.net/2021/06/04/3p5OAfFXslikRCd.jpg" alt="course"></div><p>It violates both rules for 1NF</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="decompose-into-1nf"></a>Decompose Into 1NF<a class="hash-link" href="#decompose-into-1nf" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-course_content_3"></a>Example: COURSE_CONTENT_3<a class="hash-link" href="#example-course_content_3" title="Direct link to heading">#</a></h4><div style="zoom:0.5" class="text--center"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gqwyd8q7qrj30lc0aywgk.jpg" alt="course_content_3"></div><p>Not in 1NF</p><p>Because there 2 tuple values in COURSE_CONTENT</p><p>We can decompose it:</p><div style="zoom:0.5" class="text--center"><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gqwyd8q7qrj30lc0aywgk.jpg" alt="course_content_3"></div><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gqwyep49exj30nc0ekgo4.jpg" alt="COURSE_CONTENT_4"></p><p>In 1NF</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="second-normal-form-2nf"></a><u>Second Normal Form (2NF)</u><a class="hash-link" href="#second-normal-form-2nf" title="Direct link to heading">#</a></h3><p>A relation is in 2NF if both of the following conditions hold:</p><ul><li>It is in <strong>1NF</strong> (first normal form).</li><li>No non-prime attribute is functionally dependent on a proper subset of any candidate key.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="non-prime-attribute"></a>Non-prime attribute<a class="hash-link" href="#non-prime-attribute" title="Direct link to heading">#</a></h4><p>An attribute that is <strong>not part of any candidate key</strong> is a NON-PRIME ATTRIBUTE.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="-functionally-dependent"></a>✨ Functionally dependent<a class="hash-link" href="#-functionally-dependent" title="Direct link to heading">#</a></h4><p>If a set of attributes A of a relation <strong>uniquely identifies</strong> a set of attributes B of the same relation, then <strong>B is FUNCTIONALLY DEPENDENT on A</strong>.
Written: <code>A--&gt;B</code> (just one long arrow)
• Functional Dependency: The value of one attribute (the determinant) determines the value of another attribute.
– A--&gt;B reads “Attribute B is functionally dependent on A”
– A--&gt;B means <strong>if two rows have same value of A they necessarily have same value of B</strong>
– FDs are determined by semantics: You can’t say that a FD exists just by looking at data. But can say whether it does not exist by looking at data.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="proper-subset"></a>Proper subset<a class="hash-link" href="#proper-subset" title="Direct link to heading">#</a></h4><p>A proper subset of a set A is a subset of A that is not equal to A.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-functional-dependencies-fds"></a>Example: Functional Dependencies (FD&#x27;s)<a class="hash-link" href="#example-functional-dependencies-fds" title="Direct link to heading">#</a></h4><p><em>If a set of attributes A of are relation uniquely identifies a set of attributes B of the same relation, then B is FUNCTIONALLY DEPENDENT on A. Written:A---&gt;B</em></p><p>Schema: <strong>STUDENT (ID, NAME, ADDRESS)</strong></p><p>{ID} uniquely identifies the following sets of attributes {NAME}, {ADDRESS}, {NAME, ADDRESS}</p><ul><li><em>If {ID} uniquely identifies {NAME, ADDRESS}, then it also uniquely identifies {NAME} and {ADDRESS}.</em></li></ul><p>NAME and ADDRESS are both FUNCTIONALLY DEPENDENT on ID. Written:</p><ul><li>{ID}---&gt;{NAME}</li><li>{ID}---&gt;{ADDRESS}</li><li>{ID}---&gt;{NAME, ADDRESS}</li></ul><p><em>(Not required to use {}, just be absolutely clear about what you&#x27;re meaning)</em></p><p><em>Theory of relational database replies on advanced set theory. It&#x27;s mathematically precise and consistent. If you do more work in database, you will need to understand quite a lot of set theory before you can continue.</em></p><p><strong>Continued</strong>:</p><ul><li>ID---&gt;{NAME} (read: <strong>NAME is functionally dependent on ID</strong>)</li><li>ID---&gt;{ADDRESS}</li><li>ID---&gt;{NAME, ADDRESS}</li></ul><p>ID---&gt;{NAME} can therefore also be read: <strong>ID functionally determines NAME</strong></p><ul><li>You should be familiar with both of these terms with both functionally dependent and functionally determines.</li><li>MEANING:<ul><li>For any given ID, there can only be one name. Similarly, for address.</li></ul></li><li>However, it would be <strong>incorrect to write NAME--&gt;{ID}</strong><ul><li>MEANING:<ul><li>For any given NAME, <strong>there can only be one ID</strong> —— not the case</li><li>NAME functionally determines ID and ID is functionally determined by NAME</li></ul></li></ul></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-2nf-relation-school"></a>Example: 2NF Relation SCHOOL<a class="hash-link" href="#example-2nf-relation-school" title="Direct link to heading">#</a></h4><div style="zoom:0.6"><img src="https://tva1.sinaimg.cn/large/008i3skNly1gqwz1p38r2j30j60bmmz4.jpg" alt="SCHOOL"></div><ol><li><p>Is the relation SCHOOL in 1NF?</p><p>YES</p></li><li><p>Are there any <strong>non-prime attributes that are functionally dependent on a proper subset of any candidate key</strong>?</p><p>If so, the relation is <strong>not</strong> in 2NF.</p><ul><li><p>Candidate key: <strong>{FACULTY_ID, CLASS}</strong></p></li><li><p>Proper subsets of candidate keys: {FACULTY_ID},{CLASS}</p></li><li><p>Non-Prime attributes: {FACULTY, AGE}
(<em>An attribute that is not part of any candidate key is a non-prime attribute</em>)</p></li><li><p><strong>Identify Functional Dependencies (FD&#x27;s) associated with non-prime attributes.</strong></p><p>Does <strong>FACULTY_ID---&gt; FACULTY_AGE</strong> hold? YES.</p></li><li><p>Non-prime attribute FACULTY_AGE is <strong>dependent</strong> on FACULY_ID which is a proper subset of the candidate key.</p></li></ul></li></ol><p>Therefore, the relation SCHOOL is <strong>not</strong> in 2NF.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="why-does-whether-the-relation-is-2nf-or-not-matters"></a>Why does whether the relation is 2NF or not <strong>matters</strong>?<a class="hash-link" href="#why-does-whether-the-relation-is-2nf-or-not-matters" title="Direct link to heading">#</a></h4><p>Because there are possibility of <strong>Update anomalies, Insertion anomalies and Deletion anomalies</strong>.</p><p>Try to think of some possible anomalies.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="summary-of-examples-so-far"></a>Summary of examples so far<a class="hash-link" href="#summary-of-examples-so-far" title="Direct link to heading">#</a></h4><ul><li><p>Is the SCHOOL below in 1NF? —— YES</p></li><li><p>Candidate key: {FACULTY_ID, CLASS} and hence Primary Key Non-Prime attributes: FACULTY_AGE</p></li><li><p>Relation not in 2NF</p></li><li><p>The non-prime attribute FACULTY_AGE is functionally dependent on FACULTY_ID.</p><p>This violates 2NF which requires that:</p><p>No non-prime attribute is <strong>functionally dependent</strong> on a proper subset of any candidate key.</p></li></ul><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="decompose-into-2nf"></a>Decompose into 2NF<a class="hash-link" href="#decompose-into-2nf" title="Direct link to heading">#</a></h3><blockquote><p>按照“主键的值可以确定其他列的值”原则来分表</p></blockquote><p><strong>Steps</strong>:</p><ol><li>When there is an FD, X--&gt;Y on part of the candidate key(X is part of candidate key), <strong>form a new relation</strong> with <strong>X as primary key</strong> and with <strong>all the attributes determined by X.</strong> </li><li>Form a new relation defined on the attributes of the <strong>candidate keys</strong> of the original relation and include <strong>all attributes that are not functionally determined by only part of the key</strong>.</li></ol><p><strong>Example(continued):</strong></p><ul><li>The candidate key is:{FACULTY_ID, CLASS}</li></ul><div style="size:0.6px"><img src="https://tva1.sinaimg.cn/large/008i3skNly1gqwz1p38r2j30j60bmmz4.jpg" alt="ta"></div><p>Applying the steps to the SCHOOL relation</p><ol><li><p><strong>STEP 1</strong></p><ul><li>FACULTY<em>ID ---&gt; FACULTY_AGE </em>(READ: FACULTY<em>ID functionally determines FACULTY_AGE)</em></li><li>Form a new relation with FACULTY_ID as primary key and FACULTY_AGE as attribute</li></ul></li></ol><div style="zoom:0.6"><img src="https://i.loli.net/2021/06/04/hxokQKG6RAUs7De.jpg" alt="SCHOOL2"></div><ol start="2"><li><p><strong>STEP 2</strong></p><ul><li>Form a new relation defined on the attributes of the key of the original relation. New relation has FACULTY_ID, CLASS as attributes./&gt;</li><li>FACULTY_AGE is determined by only part of the key, so is not included.</li></ul></li></ol><div style="zoom:0.6"><img src="https://i.loli.net/2021/06/04/ThKlvjm6ceZV13s.jpg" alt="SCHOOL3"></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-relation-ta-continued"></a>Example: Relation TA Continued<a class="hash-link" href="#example-relation-ta-continued" title="Direct link to heading">#</a></h4><div style="zoom:0.6"><img src="https://i.loli.net/2021/06/04/rgV1eZFiOyaSCTM.jpg" alt="SCHOOL"></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="normalize-the-ta-relation-to-comply-with-2nf"></a>Normalize the TA relation to comply with 2NF<a class="hash-link" href="#normalize-the-ta-relation-to-comply-with-2nf" title="Direct link to heading">#</a></h3><ol><li><p>TA is in 1NF</p></li><li><p>Candidate key: <code>{TA_ID, TA_DEPT}</code></p></li><li><p>Non-prime attributes: <code>{TA_NAME, TA_ADDRESS}</code></p></li><li><p>Functional dependencies:</p><ol><li><code>TA_ID---&gt;{TA_NAME, TA_ADDRESS}</code></li><li><code>TA_ID---&gt;{TA_NAME}</code></li><li><code>TA_ID---&gt;{TA_ADDRESS}</code></li></ol></li><li><p>Non-prime attributes functionally <strong>dependent</strong> on proper subset of candidate key, so TA <strong>not</strong> in 2NF</p></li><li><p>So we need to <strong>decompose</strong> it into 2NF:</p><ol><li><p>Step 1: <em>When there is an FD, X--&gt;Y on part of the candidate key, <strong>form a new relation</strong> with <strong>X as primary key</strong> and with <strong>all the attributes determined by X.</strong></em></p><ul><li>FD: <code>TA_ID---&gt;{TA_NAME}</code> and <code>TA_ID---&gt;{TA_ADDRESS}</code></li><li>Candidate keys: <code>{TA_ID, TA_DEPT}</code></li><li>Form a new relation with TA_ID as primary key and TA_NAME and TA_ADDRESS as attributes</li></ul></li></ol></li></ol><div style="zoom:0.6"><img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/002a62db-f55f-45ea-a8c9-e1c5b97ee3c3/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210602%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210602T230931Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=d305d70a157d19ec9b3f9672e0899749975fabed33bc3a2da5319e6118503471&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%22Untitled.png%22" alt="TA2"></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Duplicate tuples removed because of primary key in new relation</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><ol start="2"><li><p>Step 2: <em>Form a new relation defined on the attributes of the <strong>candidate keys</strong> of the original relation and include <strong>all attributes that are not functionally determined by only part of the key</strong>.</em></p><ul><li>Candidate keys: {TA_ID, TA_DEPT}</li><li>{TA_NAME} and {TA_ADDRESS} are functionally determined by TA_ID, which is part of the key —— so are not included in the new relation attributes</li><li>New relation attributes: {TA_ID}, {TA_DEPT}</li></ul><p><img src="https://s3.us-west-2.amazonaws.com/secure.notion-static.com/9e56f63f-b919-4324-9c60-2524bbef6e7d/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAT73L2G45O3KS52Y5%2F20210602%2Fus-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20210602T231004Z&amp;X-Amz-Expires=86400&amp;X-Amz-Signature=fa0531dd8cec713b58fbec73908ded50fb5ecdee1b40208652a223c155327db3&amp;X-Amz-SignedHeaders=host&amp;response-content-disposition=filename%20%3D%22Untitled.png%22" alt="TA3"></p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="update-anomaly"></a>UPDATE ANOMALY<a class="hash-link" href="#update-anomaly" title="Direct link to heading">#</a></h4><p>Ann belongs to two departments. If Ann&#x27;s <strong>address changes</strong>, we will need to update TWO tuples to avoid ambiguity.</p><p>Ann&#x27;s address might be updated in MATH but not in STATS; an inconsistency.</p><p>Have we <strong>resolved the update anomaly</strong>?</p><p>Yes. We only need update ONE tuple. —— <strong>update the first tuple in TA2</strong></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="insert-anomaly"></a>INSERT ANOMALY<a class="hash-link" href="#insert-anomaly" title="Direct link to heading">#</a></h4><p>Suppose a new TA has been appointed but does not yet know which department they will work in.</p><p>Have we <strong>resolve the INSERT anomaly</strong>?</p><p>Yes. We can record the new TA&#x27;s details without having to specify their department.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="delete-anomaly"></a>DELETE ANOMALY<a class="hash-link" href="#delete-anomaly" title="Direct link to heading">#</a></h4><p>Suppose the BIOLOGY department is closed down.</p><p>Deleting tuples with attribute value BIOLOGY in TA_DEPT would delete the information about Bob.</p><p>Have we <strong>resolve the DELETE anomaly</strong>?</p><p>Yes. We can delete biology department without deleting Bob&#x27;s information.</p><hr><p><a href="https://www.notion.so/lavendershuo/Lecture-19-3NF-and-R-Review-882ec061fa174f63a7b50cf241ea3b29" target="_blank" rel="noopener noreferrer">3NF Lecture Notes</a></p><p><em>3NF quickly beyonds the scope of PSTAT10. All we need to know is the content mentioned in the powerpoint slides.</em></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="third-normal-3nf"></a><u>Third Normal 3NF</u><a class="hash-link" href="#third-normal-3nf" title="Direct link to heading">#</a></h3><p>A relation is in 3NF if both of the following conditions hold:</p><ol><li>the relation is in <strong>2NF</strong>.</li><li>there are no <strong>TRANSITIVE FUNCTIONAL DEPENDENCIES</strong> of NON-PRIME ATTRIBUTES on the primary key.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="transitive-functional-dependencies"></a>Transitive Functional Dependencies<a class="hash-link" href="#transitive-functional-dependencies" title="Direct link to heading">#</a></h3><p>If <strong>A---&gt;B</strong> and <strong>B---&gt;C</strong> are two Functional Dependencies, then <strong>A---&gt;C</strong> is a TRANSITIVE FUNCTIONAL DEPENDENCY.</p><p><em>Recall:</em></p><ul><li><em>If a set of attributes A of a relation uniquely identifies a set of attributes B of the same relation, then B is <strong>FUNCTIONALLY DEPENDENT</strong> on A. Written: A ---&gt; B</em></li><li><em>An attribute that is not part of any candidate key is a <strong>NON-PRIME ATTRIBUTE</strong>.</em></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="a-simple-example-of-3nf"></a>A simple example of 3NF<a class="hash-link" href="#a-simple-example-of-3nf" title="Direct link to heading">#</a></h3><p>Consider the following relation schema: <code>Student_Address (STUDENT_ID, STUDENT_NAME, ZIP, STATE, CITY)</code></p><p><em>It&#x27;s always important to state your assumptions</em></p><p>Assumptions: Each student has a unique STUDENT_ID and only one address, denoted by ZIP, STATE, CITY</p><p><em>Review for these concepts:</em></p><ul><li><p>Super-keys: {STUDENT_ID}, {STUDENT_ID, STUDENT_NAME} and so on…</p></li><li><p>Candidate keys: {STUDENT_ID}</p></li><li><p>Primary key: {STUDENT_ID}</p></li><li><p>Non-prime attributes: {STUDENT_NAME, ZIP, STATE, CITY}</p></li></ul><p>→ ⚠️ 2NF holds. </p><blockquote><p><em>2NF will hold Relation is in 1NF and no non-prime attribute is functionally dependent on a proper subset of any candidate key</em>.</p></blockquote><blockquote><p><em>3NF will hold if there are no TRANSITIVE FUNCTIONAL DEPENDENCIES of NON-PRIME ATTRIBUTES on the primary key.</em></p></blockquote><p><code>ZIP</code> is functionally dependent on <code>STUDENT_ID</code>.</p><p><code>STATE</code> and <code>CITY</code> is functionally dependent on <code>ZIP</code>.</p><p>Thus,</p><ul><li><code>STUDENT_ID —&gt; ZIP</code></li><li><code>ZIP —&gt; {STATE, CITY}</code></li></ul><blockquote><p><em>If A —&gt; B and B —&gt; C are two FDs, then A —&gt; C is a transitive functional dependency.</em></p></blockquote><p><code>{STATE, CITY}</code> is transitively functionally dependent on <code>STUDENT_ID</code>, <code>STUDENT_ID —&gt; {STATE, CITY}</code></p><p><code>STATE</code> and <code>CITY</code> are non-prime attributes. <code>STUDENT_ID</code> is the primary key.</p><p>Thus, the relation <code>STUDENT_ADDRESS</code> violates third formal form requirements, not in 3NF.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="decompose-into-3nf"></a>Decompose into 3NF<a class="hash-link" href="#decompose-into-3nf" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-continued"></a>Example continued<a class="hash-link" href="#example-continued" title="Direct link to heading">#</a></h4><ul><li><p><code>Student_Address (STUDENT_ID, STUDENT_NAME, ZIP, STATE, CITY)</code></p></li><li><p><code>STUDENT_ID —&gt; ZIP</code> functional dependency</p></li><li><p><code>ZIP —&gt; {STATE, CITY}</code> functional dependency</p></li><li><p><code>STUDENT_ID —&gt; {STATE, CITY}</code>  transitive functional dependency</p></li></ul><p>In order to conform with 3NF, we need to <strong>remove that transitive functional dependency</strong>.</p><p>Form a new relation that includes all attributes in the schema <strong>except those that were transitively determined</strong>.</p><p>New relation schema: SA2 (<u>STUDENT_ID</u>, STUDENT_NAME, ZIP) (not include STATE, CITY)</p><p>This leaves us with attributes <code>STATE</code> and <code>CITY</code>.</p><p>→ Form a new relation defined on these attributes with <code>ZIP</code> as primary key, since ZIP —&gt; {STATE, CITY}</p><p>New relation schema: SA3 (<u>ZIP</u>, STATE, CITY)</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/SQL Notes/Normalization.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/SQL Notes/sqlorder"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Ordering</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/SQL Notes/sqlgroup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SQL Grouping »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-a-good-relation-design-well-structured-relation" class="table-of-contents__link">What is a good relation design (Well-Structured Relation)?</a></li><li><a href="#normalization" class="table-of-contents__link">Normalization</a></li><li><a href="#anormalies--example-relation-ta" class="table-of-contents__link"><u>Anormalies</u> | Example: Relation TA</a></li><li><a href="#normal-forms" class="table-of-contents__link"><u>Normal Forms</u></a><ul><li><a href="#first-normal-form（1nf" class="table-of-contents__link"><u>First Normal Form（1NF)</u></a></li><li><a href="#decompose-into-1nf" class="table-of-contents__link">Decompose Into 1NF</a></li><li><a href="#second-normal-form-2nf" class="table-of-contents__link"><u>Second Normal Form (2NF)</u></a></li><li><a href="#decompose-into-2nf" class="table-of-contents__link">Decompose into 2NF</a></li><li><a href="#normalize-the-ta-relation-to-comply-with-2nf" class="table-of-contents__link">Normalize the TA relation to comply with 2NF</a></li><li><a href="#third-normal-3nf" class="table-of-contents__link"><u>Third Normal 3NF</u></a></li><li><a href="#transitive-functional-dependencies" class="table-of-contents__link">Transitive Functional Dependencies</a></li><li><a href="#a-simple-example-of-3nf" class="table-of-contents__link">A simple example of 3NF</a></li><li><a href="#decompose-into-3nf" class="table-of-contents__link">Decompose into 3NF</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Start from there</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/SQL Notes/sqlintro">SQL Review Notes</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/Dynamic Programming/algointro">Algo Novice</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.96d6837b.js"></script>
<script src="/assets/js/main.ba8b2f4f.js"></script>
</body>
</html>